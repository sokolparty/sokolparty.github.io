<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload and Display Photos</title>
</head>
<body>
  <h1>Upload Your Photo</h1>

  <!-- File upload -->
  <input type="file" id="fileInput" accept="image/*">
  <button id="uploadButton">Upload Image</button>

  <h2>Uploaded Photos</h2>
  <div id="gallery"></div>

  <!-- Firebase Scripts -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getStorage, ref, uploadBytes, getDownloadURL, listAll } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";

    // Your Firebase configuration (paste your config here)
  const firebaseConfig = {
    apiKey: "AIzaSyA_P1R1-PGfykAVM_Y9B6Ajz4ckkz1vz9Q",
    authDomain: "sokolparty420.firebaseapp.com",
    projectId: "sokolparty420",
    storageBucket: "gs://sokolparty420.appspot.com", // Upewnij się, że jest poprawne
    messagingSenderId: "361570196780",
    appId: "1:361570196780:web:e1e1e419d06d475355e089",
    measurementId: "G-18TK7X35TQ"
  };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    // Handle file upload
    document.getElementById('uploadButton').addEventListener('click', async () => {
      const file = document.getElementById('fileInput').files[0];
      if (!file) {
        alert('Please select a file first');
        return;
      }

      const storageRef = ref(storage, 'uploads/' + file.name);
      await uploadBytes(storageRef, file);
      alert('File uploaded successfully');
      displayImages();
    });

    // Display uploaded images
    async function displayImages() {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = ''; // Clear the gallery before showing new images

      const listRef = ref(storage, 'uploads/');
      const res = await listAll(listRef);

      res.items.forEach(async (itemRef) => {
        const url = await getDownloadURL(itemRef);
        const img = document.createElement('img');
        img.src = url;
        img.style.width = '200px';
        img.style.margin = '10px';
        gallery.appendChild(img);
      });
    }

    // Display images on page load
    displayImages();
  </script>
</body>
</html>
